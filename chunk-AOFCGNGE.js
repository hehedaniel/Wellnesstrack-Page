import{f as oe}from"./chunk-J7F7KZJ2.js";import{a as L,b as W,f as V,g as $,i as ee,q as te,r as ie}from"./chunk-YBJLJ2WG.js";import{l as Y,m as U}from"./chunk-6OMSEINS.js";import"./chunk-N5MVP6Y3.js";import{B as Z,C as I,b as X,g as H,l as q,r as J,s as K,z as Q}from"./chunk-MZKIP52W.js";import{Ia as G,i as w}from"./chunk-OZO5R2AD.js";import"./chunk-WB557K7N.js";import{Hb as T,Lb as t,Mb as e,Nb as R,Rb as D,Ub as v,Wb as h,db as p,dc as r,ec as S,fc as k,hc as F,ic as B,ja as _,jc as z,lc as O,oa as E,wb as y,xa as b,ya as C}from"./chunk-CPJRB4V3.js";import{g as d,h as g,i as f}from"./chunk-73B72BQ3.js";var ne=(()=>{var c,i,l,o;let m=class m{constructor(){g(this,c,void 0);g(this,i,void 0);g(this,l,void 0);g(this,o,void 0);f(this,c,_(V)),f(this,i,_(w)),f(this,l,_(U)),f(this,o,_(I)),this.propiedad="",this.actual="",this.nuevoValor=""}ngOnInit(){this.actual=localStorage.getItem("oldValue")??"",this.propiedad=localStorage.getItem("propiedad")??""}actualizar(M){if(this.nuevoValor==""||this.nuevoValor==null){d(this,o).open("Por favor, rellene todos los campos","",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["error-snackbar"]});return}else{let a=localStorage.getItem("idUsuarioLogeado")??"",n="",x="",u=0,j="",A=0;M=="nombre"?n=this.nuevoValor:n=localStorage.getItem("nombre")??"",M=="apellidos"?x=this.nuevoValor:x=localStorage.getItem("apellidos")??"",M=="altura"?u=parseInt(this.nuevoValor):u=parseFloat(localStorage.getItem("altura")??"0"),M=="objetivo_opt"?j=this.nuevoValor:j=localStorage.getItem("objetivo")??"",M=="objetivo_num"?A=parseInt(this.nuevoValor):A=parseFloat(localStorage.getItem("peso_objetivo")??"0"),d(this,l).putEditarUsuario(a,n,x,u,j,A).subscribe(N=>{console.log(a),console.log(N),N.code===200&&(this.closeDialog(),location.reload())})}}closeDialog(){d(this,c).closeAll()}};c=new WeakMap,i=new WeakMap,l=new WeakMap,o=new WeakMap,m.\u0275fac=function(a){return new(a||m)},m.\u0275cmp=E({type:m,selectors:[["app-form-actualizar-datos-usuario"]],standalone:!0,features:[O],decls:20,vars:2,consts:[[1,"popUpCompleto"],[1,"cabecera"],[1,"fakeButton",3,"click"],[1,"infoUser"],[1,"input-div-disabled"],["for","actual",1,"labelInput"],["pInputText","","type","text","id","actual","disabled","true",3,"ngModelChange","ngModel"],[1,"input-div"],["for","nuevoValor",1,"labelInput"],["pInputText","","type","text","id","nuevoValor",3,"ngModelChange","ngModel"],[1,"piePopUp"],[1,"btnGuardar","fakeButton",3,"click"]],template:function(a,n){a&1&&(t(0,"div",0)(1,"div",1)(2,"h2"),r(3,"Valor actual"),e(),t(4,"h2",2),v("click",function(){return n.closeDialog()}),r(5,"X"),e()(),t(6,"div",3)(7,"div",4)(8,"label",5),r(9,"Valor actual"),e(),t(10,"input",6),z("ngModelChange",function(u){return B(n.actual,u)||(n.actual=u),u}),e()()(),t(11,"h2"),r(12,"Introduce el nuevo valor"),e(),t(13,"div",7)(14,"label",8),r(15,"Nuevo valor"),e(),t(16,"input",9),z("ngModelChange",function(u){return B(n.nuevoValor,u)||(n.nuevoValor=u),u}),e()(),t(17,"div",10)(18,"button",11),v("click",function(){return n.actualizar(n.propiedad)}),r(19,"Guardar"),e()()()),a&2&&(p(10),F("ngModel",n.actual),p(6),F("ngModel",n.nuevoValor))},dependencies:[Z,ie,Q,K,X,H,J,q,G,$,ee,te,oe],styles:[".popUpCompleto[_ngcontent-%COMP%]{margin:5% 3%}h2[_ngcontent-%COMP%]{margin-top:2%;margin-left:2%}input[_ngcontent-%COMP%]{width:100%;padding:.7rem!important;margin:1%!important;border-radius:4px!important}.input-div[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid var(--EXTRA_GRAY)!important}.input-div[_ngcontent-%COMP%], .input-div-disabled[_ngcontent-%COMP%]{display:flex!important;flex-direction:column!important;margin:1%}.input-div-disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:flex!important;flex-direction:column!important;background-color:#f5f5f5;border:1px solid var(--EXTRA_WHITE);display:flex;align-items:center}.piePopUp[_ngcontent-%COMP%]{margin-top:4%;display:flex;justify-content:space-evenly}button[_ngcontent-%COMP%]{padding:2% 4%;border-radius:10px;border:none;font-size:16px}.btnCancelar[_ngcontent-%COMP%]{background-color:var(--PRIMARY_300);color:#000}.btnGuardar[_ngcontent-%COMP%]{background-color:var(--TERTIARY_600);color:#fff}"]});let s=m;return s})();function ae(s,c){s&1&&R(0,"img",9)}function le(s,c){if(s&1){let i=D();t(0,"img",13),v("click",function(){b(i);let o=h(2);return C(o.verificarEmail(o.userEmail,"email"))}),e()}}function se(s,c){if(s&1){let i=D();t(0,"div",0)(1,"header",1)(2,"h1"),r(3),e(),t(4,"button",2),v("click",function(){b(i);let o=h();return C(o.cerrarSesion())}),r(5,"Cerrar Sesi\xF3n"),e()(),t(6,"section",3)(7,"h2"),r(8,"Informaci\xF3n Personal"),e(),t(9,"div",4)(10,"div",5)(11,"p",6),r(12,"Nombre"),e(),t(13,"p"),r(14),e(),t(15,"img",7),v("click",function(){b(i);let o=h();return C(o.editarValor(o.userNombre,"nombre"))}),e()(),t(16,"div",5)(17,"p",6),r(18,"Apellidos"),e(),t(19,"p"),r(20),e(),t(21,"img",8),v("click",function(){b(i);let o=h();return C(o.editarValor(o.userApellidos,"apellidos"))}),e()(),t(22,"div",5)(23,"p",6),r(24,"Correo"),e(),t(25,"p"),r(26),e(),y(27,ae,1,0,"img",9)(28,le,1,0),e()()(),t(29,"section",3)(30,"h2"),r(31,"Objetivos"),e(),t(32,"div",4)(33,"div",5)(34,"p",6),r(35,"Altura"),e(),t(36,"p"),r(37),e(),t(38,"img",10),v("click",function(){b(i);let o=h();return C(o.editarValor(o.userAltura,"altura"))}),e()(),t(39,"div",5)(40,"p",6),r(41,"Objetivo"),e(),t(42,"p"),r(43),e(),t(44,"img",11),v("click",function(){b(i);let o=h();return C(o.editarValor(o.userObjetivo,"objetivo_opt"))}),e()(),t(45,"div",5)(46,"p",6),r(47,"Peso Objetivo"),e(),t(48,"p"),r(49),e(),t(50,"img",12),v("click",function(){b(i);let o=h();return C(o.editarValor(o.userPesoObjetivo,"objetivo_num"))}),e()()()()()}if(s&2){let i=h();p(3),k("\xA1Bienvenido, ",i.userNombre,"!"),p(11),S(i.userNombre),p(6),S(i.userApellidos),p(6),S(i.userEmail),p(),T(27,i.correoVerificado?27:28),p(10),k("",i.userAltura," cm"),p(6),S(i.userObjetivo),p(6),k("",i.userPesoObjetivo," kg")}}function ce(s,c){s&1&&(t(0,"div",14),R(1,"mat-spinner"),e())}var Fe=(()=>{var c,i,l,o,m;let P=class P{constructor(){g(this,c,void 0);g(this,i,void 0);g(this,l,void 0);g(this,o,void 0);g(this,m,void 0);f(this,c,_(U)),f(this,i,_(Y)),f(this,l,_(w)),f(this,o,_(V)),f(this,m,_(I)),this.userNombre="",this.userApellidos="",this.userEmail="",this.correoVerificado=!1,this.userAltura=0,this.userObjetivo="",this.userPesoObjetivo=0,this.datosUsuarioRecogidos=!1}ngOnInit(){console.log("Pagina de perfil de usuario"),this.checkLogedIn(),d(this,i).fbIsUserVerified().then(a=>{this.correoVerificado=a})}checkLogedIn(){d(this,i).fbUserEmail().then(a=>{a!==null?(this.userEmail=a,this.recogerDatosUsuario(a)):d(this,l).navigate(["/login"])})}recogerDatosUsuario(a){d(this,c).getUser(this.userEmail).subscribe(n=>{n?(console.log(n),this.userNombre=n.respuesta.nombre,this.userApellidos=n.respuesta.apellidos,this.userAltura=n.respuesta.altura,this.userObjetivo=n.respuesta.objetivo_opt,this.userPesoObjetivo=n.respuesta.objetivo_num,localStorage.setItem("nombreUsuario",this.userNombre),localStorage.setItem("apellidos",this.userApellidos),localStorage.setItem("altura",this.userAltura.toString()),localStorage.setItem("objetivo",this.userObjetivo),localStorage.setItem("peso_objetivo",this.userPesoObjetivo.toString()),setTimeout(()=>{this.datosUsuarioRecogidos=!0},500)):d(this,l).navigate(["/login"])})}editarValor(a,n){console.log("Editando propiedad: "+a),localStorage.setItem("oldValue",a),localStorage.setItem("propiedad",n),d(this,o).open(ne,{width:"80%",height:"auto"})}verificarEmail(a,n){d(this,i).fbSendVerificationEmail().then(()=>{console.log("Email de verificaci\xF3n enviado"),d(this,m).open("Email de verificaci\xF3n enviado","",{duration:2e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["error-snackbar"]})})}cerrarSesion(){d(this,i).fbLogout().then(()=>{console.log("Cerrando sesi\xF3n"),localStorage.clear(),location.reload()})}};c=new WeakMap,i=new WeakMap,l=new WeakMap,o=new WeakMap,m=new WeakMap,P.\u0275fac=function(n){return new(n||P)},P.\u0275cmp=E({type:P,selectors:[["app-usuario-perfil"]],standalone:!0,features:[O],decls:2,vars:1,consts:[[1,"perfilUsuario"],[1,"header"],[1,"btnCerrarSesion",3,"click"],[1,"seccionPerfil"],[1,"infoUsuario"],[1,"datoUsuario"],[1,"label"],["src","../../../assets/icons/editBlack12.svg","alt","Editar nombre","title","Editar nombre",1,"icono",3,"click"],["src","../../../assets/icons/editBlack12.svg","alt","Edita apellidos","title","Edita apellidos",1,"icono",3,"click"],["src","../../../assets/icons/verifiedBlack12.svg","alt","Correo Verificado","title","Correo Verificado",1,"icono"],["src","../../../assets/icons/editBlack12.svg","alt","Editar altura title=","Editar","","altura","",1,"icono",3,"click"],["src","../../../assets/icons/editBlack12.svg","alt","Editar objetivo","title","Editar objetivo",1,"icono",3,"click"],["src","../../../assets/icons/editBlack12.svg","alt","Editar peso objetivo","title","Editar peso objetivo",1,"icono",3,"click"],["src","../../../assets/icons/reloadBlack12.svg","alt","Correo no Verificado","title","Verificar Correo",1,"icono",3,"click"],[1,"spinnerClass"]],template:function(n,x){n&1&&y(0,se,51,8,"div",0)(1,ce,2,0),n&2&&T(0,x.datosUsuarioRecogidos?0:1)},dependencies:[W,L],styles:["body[_ngcontent-%COMP%]{display:flex!important;flex-direction:column!important;justify-content:center!important;align-items:center!important}.header[_ngcontent-%COMP%]{background-color:var(--PRIMARY_500);color:#fff;background-color:var(--SECONDARY_50);color:#000;padding:20px;display:flex;justify-content:space-between;align-items:center;border-radius:12px;margin-bottom:20px}.perfilUsuario[_ngcontent-%COMP%]{background-color:var(--SECONDARY_50);max-width:70%;margin:auto;padding:20px;margin-top:10vh;border-radius:12px;box-shadow:-4px 4px 8px #0000001a,0 4px 8px #0000001a}.seccionPerfil[_ngcontent-%COMP%]{margin-bottom:20px}.seccionPerfil[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--PRIMARY_600);border-bottom:2px solid var(--PRIMARY_600);margin-bottom:10px;padding-bottom:5px}.infoUsuario[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px}.datoUsuario[_ngcontent-%COMP%]{flex:1 1 calc(33.333% - 20px);background:var(--EXTRA_WHITE_LIGHTER);padding:15px;border-radius:8px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 4px #0000001a}.datoUsuario[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-weight:700;overflow:hidden;text-overflow:ellipsis!important}.label[_ngcontent-%COMP%]{color:#666;margin-bottom:5px}.icono[_ngcontent-%COMP%]{width:16px;height:16px;cursor:pointer}.btnCerrarSesion[_ngcontent-%COMP%]{cursor:pointer;border:0;border-radius:8px;width:25%;height:auto;padding:.3rem;color:#fff;background-color:var(--PRIMARY_500)}.spinnerClass[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:90%}@media (max-width: 1200px){.datoUsuario[_ngcontent-%COMP%]{flex:1 1 100%;max-width:100%;box-sizing:border-box}}@media (max-width: 768px){.datoUsuario[_ngcontent-%COMP%]{flex:1 1 100%;max-width:100%;box-sizing:border-box}}@media (max-width: 576px){*[_ngcontent-%COMP%]{width:100%}.datoUsuario[_ngcontent-%COMP%]{flex:1 1 100%;max-width:100%;box-sizing:border-box}.header[_ngcontent-%COMP%]{flex-direction:column}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;width:100%}.btnCerrarSesion[_ngcontent-%COMP%]{font-size:14px;width:100%}.perfilUsuario[_ngcontent-%COMP%]{width:90%;max-width:90%;margin-top:5vh}}"]});let s=P;return s})();export{Fe as UsuarioPerfilComponent};
