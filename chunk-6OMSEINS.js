import{a as Ne,b as oe,c as Fe,d as xe,e as se,f as je,g as ae,h as $e,i as ce,j as K,k as T,l as E}from"./chunk-N5MVP6Y3.js";import{a as Me,n as O}from"./chunk-OZO5R2AD.js";import{s as Oe}from"./chunk-WB557K7N.js";import{$ as Re,D as _e,Da as Ce,E as Pe,Gc as ie,La as $,P as B,U as te,X as P,Y as ne,c as D,da as v,f as ve,ga as g,ia as f,j as ye,ja as j,k as Ie,ka as W,m as b,mb as R,n as _,o as ee,p as x,sa as Se,t as V,wc as De,xc as re}from"./chunk-CPJRB4V3.js";import{g as p,h as F,i as Q,k as l}from"./chunk-73B72BQ3.js";var ot="firebase",st="10.12.2";T(ot,st,"app");var G=new De("ANGULARFIRE2_VERSION");function pn(e,t,n){if(t){if(t.length===1)return t[0];let i=t.filter(s=>s.app===n);if(i.length===1)return i[0]}return n.container.getProvider(e).getImmediate({optional:!0})}var at=(e,t)=>{let n=t?[t]:K(),r=[];return n.forEach(o=>{o.container.getProvider(e).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},U=class{constructor(){return at(ct)}},ct="app-check";function M(){}var q=class{zone;delegate;constructor(t,n=Ie){this.zone=t,this.delegate=n}now(){return this.delegate.now()}schedule(t,n,r){let o=this.zone,i=function(s){o.runGuarded(()=>{t.apply(this,[s])})};return this.delegate.schedule(i,n,r)}},ue=class{zone;task=null;constructor(t){this.zone=t}call(t,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",M,{},M,M)),n.pipe(Re({next:r,complete:r,error:r})).subscribe(t).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Z=(()=>{class e{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new q(Zone.current)),this.insideAngular=n.run(()=>new q(Zone.current,ye)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||e)(f(R))};static \u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function X(){let e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return e}function ut(e){return X().ngZone.runOutsideAngular(()=>e())}function S(e){return X().ngZone.run(()=>e())}function de(e){return lt(X())(e)}function lt(e){return function(n){return n=n.lift(new ue(e.ngZone)),n.pipe(_(e.outsideAngular),b(e.insideAngular))}}var dt=(e,t)=>function(){let r=arguments;return t&&setTimeout(()=>{t.state==="scheduled"&&t.invoke()},10),S(()=>e.apply(void 0,r))},Ue=(e,t)=>function(){let n,r=arguments;for(let i=0;i<arguments.length;i++)typeof r[i]=="function"&&(t&&(n||=S(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",M,{},M,M))),r[i]=dt(r[i],n));let o=ut(()=>e.apply(this,r));if(!t)if(o instanceof D){let i=X();return o.pipe(_(i.outsideAngular),b(i.insideAngular))}else return S(()=>o);return o instanceof D?o.pipe(de):o instanceof Promise?S(()=>new Promise((i,s)=>o.then(a=>S(()=>i(a)),a=>S(()=>s(a))))):typeof o=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),o.apply(this,arguments)}:S(()=>o)};var L=class{constructor(t){return t}},pe=class{constructor(){return K()}};function ft(e){return e&&e.length===1?e[0]:new L(ce())}var fe=new g("angularfire2._apps"),ht={provide:L,useFactory:ft,deps:[[new W,fe]]},gt={provide:pe,deps:[[new W,fe]]};function mt(e){return(t,n)=>{let r=n.get($);T("angularfire",G.full,"core"),T("angularfire",G.full,"app"),T("angular",re.full,r.toString());let o=t.runOutsideAngular(()=>e(n));return new L(o)}}function bn(e,...t){return Se([ht,gt,{provide:fe,useFactory:mt(e),multi:!0,deps:[R,Ce,Z,...t]}])}var vn=Ue($e,!0);var At=new Map,Et={activated:!1,tokenObservers:[]},kt={initialized:!1,enabled:!1};function A(e){return At.get(e)||Object.assign({},Et)}function Be(){return kt}var Tt="https://content-firebaseappcheck.googleapis.com/v1";var wt="exchangeDebugToken",Le={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},xn=24*60*60*1e3;var ge=class{constructor(t,n,r,o,i){if(this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=o,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=o,o>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){return l(this,null,function*(){this.stop();try{this.pending=new oe,this.pending.promise.catch(n=>{}),yield bt(this.getNextRun(t)),this.pending.resolve(),yield this.pending.promise,this.pending=new oe,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function bt(e){return new Promise(t=>{setTimeout(t,e)})}var vt={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},y=new xe("appCheck","AppCheck",vt);function We(e){if(!A(e).activated)throw y.create("use-before-activation",{appName:e.name})}function Ke(r,o){return l(this,arguments,function*({url:e,body:t},n){let i={"Content-Type":"application/json"},s=n.getImmediate({optional:!0});if(s){let m=yield s.getHeartbeatsHeader();m&&(i["X-Firebase-Client"]=m)}let a={method:"POST",body:JSON.stringify(t),headers:i},c;try{c=yield fetch(e,a)}catch(m){throw y.create("fetch-network-error",{originalErrorMessage:m?.message})}if(c.status!==200)throw y.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(m){throw y.create("fetch-parse-error",{originalErrorMessage:m?.message})}let h=u.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw y.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let C=Number(h[1])*1e3,z=Date.now();return{token:u.token,expireTimeMillis:z+C,issuedAtTimeMillis:z}})}function qe(e,t){let{projectId:n,appId:r,apiKey:o}=e.options;return{url:`${Tt}/projects/${n}/apps/${r}:${wt}?key=${o}`,body:{debug_token:t}}}var yt="firebase-app-check-database",It=1,me="firebase-app-check-store";var Y=null;function _t(){return Y||(Y=new Promise((e,t)=>{try{let n=indexedDB.open(yt,It);n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{var o;t(y.create("storage-open",{originalErrorMessage:(o=r.target.error)===null||o===void 0?void 0:o.message}))},n.onupgradeneeded=r=>{let o=r.target.result;switch(r.oldVersion){case 0:o.createObjectStore(me,{keyPath:"compositeKey"})}}}catch(n){t(y.create("storage-open",{originalErrorMessage:n?.message}))}}),Y)}function Pt(e,t){return Rt(St(e),t)}function Rt(e,t){return l(this,null,function*(){let r=(yield _t()).transaction(me,"readwrite"),i=r.objectStore(me).put({compositeKey:e,value:t});return new Promise((s,a)=>{i.onsuccess=c=>{s()},r.onerror=c=>{var u;a(y.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function St(e){return`${e.options.appId}-${e.name}`}var Ae=new je("@firebase/app-check");function he(e,t){return Fe()?Pt(e,t).catch(n=>{Ae.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function Ge(){return Be().enabled}function Ze(){return l(this,null,function*(){let e=Be();if(e.enabled&&e.token)return e.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Ct={error:"UNKNOWN_ERROR"};function Dt(e){return Ne.encodeString(JSON.stringify(e),!1)}function Ee(e,t=!1){return l(this,null,function*(){let n=e.app;We(n);let r=A(n),o=r.token,i;if(o&&!H(o)&&(r.token=void 0,o=void 0),!o){let c=yield r.cachedTokenPromise;c&&(H(c)?o=c:yield he(n,void 0))}if(!t&&o&&H(o))return{token:o.token};let s=!1;if(Ge()){r.exchangeTokenPromise||(r.exchangeTokenPromise=Ke(qe(n,yield Ze()),e.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),s=!0);let c=yield r.exchangeTokenPromise;return yield he(n,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),s=!0),o=yield A(n).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Ae.warn(c.message):Ae.error(c),i=c}let a;return o?i?H(o)?a={token:o.token,internalError:i}:a=ze(i):(a={token:o.token},r.token=o,yield he(n,o)):a=ze(i),s&&Ft(n,a),a})}function Ot(e){return l(this,null,function*(){let t=e.app;We(t);let{provider:n}=A(t);if(Ge()){let r=yield Ze(),{token:o}=yield Ke(qe(t,r),e.heartbeatServiceProvider);return{token:o}}else{let{token:r}=yield n.getToken();return{token:r}}})}function Mt(e,t,n,r){let{app:o}=e,i=A(o),s={next:n,error:r,type:t};if(i.tokenObservers=[...i.tokenObservers,s],i.token&&H(i.token)){let a=i.token;Promise.resolve().then(()=>{n({token:a.token}),He(e)}).catch(()=>{})}i.cachedTokenPromise.then(()=>He(e))}function Xe(e,t){let n=A(e),r=n.tokenObservers.filter(o=>o.next!==t);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function He(e){let{app:t}=e,n=A(t),r=n.tokenRefresher;r||(r=Nt(e),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function Nt(e){let{app:t}=e;return new ge(()=>l(this,null,function*(){let n=A(t),r;if(n.token?r=yield Ee(e,!0):r=yield Ee(e),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=A(t);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,o=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,o),Math.max(0,r-Date.now())}else return 0},Le.RETRIAL_MIN_WAIT,Le.RETRIAL_MAX_WAIT)}function Ft(e,t){let n=A(e).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&t.error!=null?r.error(t.error):r.next(t)}catch{}}function H(e){return e.expireTimeMillis-Date.now()>0}function ze(e){return{token:Dt(Ct),error:e}}var ke=class{constructor(t,n){this.app=t,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:t}=A(this.app);for(let n of t)Xe(this.app,n.next);return Promise.resolve()}};function xt(e,t){return new ke(e,t)}function jt(e){return{getToken:t=>Ee(e,t),getLimitedUseToken:()=>Ot(e),addTokenListener:t=>Mt(e,"INTERNAL",t),removeTokenListener:t=>Xe(e.app,t)}}var $t="@firebase/app-check",Ut="0.8.4";var Lt="app-check",Ve="app-check-internal";function Ht(){ae(new se(Lt,e=>{let t=e.getProvider("app").getImmediate(),n=e.getProvider("heartbeat");return xt(t,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider(Ve).initialize()})),ae(new se(Ve,e=>{let t=e.getProvider("app-check").getImmediate();return jt(t)},"PUBLIC").setInstantiationMode("EXPLICIT")),T($t,Ut)}Ht();var zt=["localhost","0.0.0.0","127.0.0.1"],Gn=typeof window<"u"&&zt.includes(window.location.hostname);var Bt="firebase",Wt="10.12.2";E.registerVersion(Bt,Wt,"app-compat");var Kt=["ngOnDestroy"],Je=(e,t,n,r={})=>new Proxy(e,{get:(o,i)=>n.runOutsideAngular(()=>{if(e[i])return r?.spy?.get&&r.spy.get(i,e[i]),e[i];if(Kt.indexOf(i)>-1)return()=>{};let s=t.toPromise().then(a=>{let c=a?.[i];return typeof c=="function"?c.bind(a):c?.then?c.then(u=>n.run(()=>u)):n.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>s[c],apply:(a,c,u)=>s.then(h=>{let C=h?.(...u);return r?.spy?.apply&&r.spy.apply(i,u,C),C})})})});var Te=class{constructor(t){return t}},Qe=new g("angularfire2.app.options"),et=new g("angularfire2.app.name");function tt(e,t,n){let r=typeof n=="string"&&n||"[DEFAULT]",o=typeof n=="object"&&n||{};o.name=o.name||r;let s=E.apps.filter(a=>a&&a.name===o.name)[0]||t.runOutsideAngular(()=>E.initializeApp(e,o));try{if(JSON.stringify(e)!==JSON.stringify(s.options)){let a=!!module.hot;qt("error",`${s.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Te(s)}var qt=(e,...t)=>{ie()&&typeof console<"u"&&console[e](...t)};function nt(e,t,n,r,o){let[,i,s]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===e)||[];if(i)return Gt(o,s)||(Ye("error",`${t} was already initialized on the ${n} Firebase App with different settings.${Zt?" You may need to reload as Firebase is not HMR aware.":""}`),Ye("warn",{is:o,was:s})),i;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([e,a,o]),a}}function Gt(e,t){try{return e.toString()===t.toString()}catch{return e===t}}var Zt=typeof module<"u"&&!!module.hot,Ye=(e,...t)=>{ie()&&typeof console<"u"&&console[e](...t)};globalThis.\u0275AngularfireInstanceCache||=[];var Xt=new g("angularfire2.auth.use-emulator"),Yt=new g("angularfire2.auth.settings"),Jt=new g("angularfire2.auth.tenant-id"),Qt=new g("angularfire2.auth.langugage-code"),en=new g("angularfire2.auth.use-device-language"),tn=new g("angularfire.auth.persistence"),nn=(e,t,n,r,o,i,s,a)=>nt(`${e.name}.auth`,"AngularFireAuth",e.name,()=>{let c=t.runOutsideAngular(()=>e.auth());if(n&&c.useEmulator(...n),r&&(c.tenantId=r),c.languageCode=o,i&&c.useDeviceLanguage(),s)for(let[u,h]of Object.entries(s))c.settings[u]=h;return a&&c.setPersistence(a),c},[n,r,o,i,s,a]),rt=(()=>{class e{authState;idToken;user;idTokenResult;credential;constructor(n,r,o,i,s,a,c,u,h,C,z,m){let we=new ve,N=x(void 0).pipe(b(s.outsideAngular),P(()=>i.runOutsideAngular(()=>import("./chunk-6CAQRUK3.js"))),V(()=>tt(n,i,r)),V(w=>nn(w,i,a,u,h,C,c,z)),te({bufferSize:1,refCount:!1}));if(Oe(o))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=x(null);else{N.pipe(B()).subscribe();let w=N.pipe(P(d=>d.getRedirectResult().then(k=>k,()=>null)),de,te({bufferSize:1,refCount:!1})),be=N.pipe(P(d=>new D(k=>({unsubscribe:i.runOutsideAngular(()=>d.onAuthStateChanged(I=>k.next(I),I=>k.error(I),()=>k.complete()))})))),J=N.pipe(P(d=>new D(k=>({unsubscribe:i.runOutsideAngular(()=>d.onIdTokenChanged(I=>k.next(I),I=>k.error(I),()=>k.complete()))}))));this.authState=w.pipe(ne(be),_(s.outsideAngular),b(s.insideAngular)),this.user=w.pipe(ne(J),_(s.outsideAngular),b(s.insideAngular)),this.idToken=this.user.pipe(P(d=>d?ee(d.getIdToken()):x(null))),this.idTokenResult=this.user.pipe(P(d=>d?ee(d.getIdTokenResult()):x(null))),this.credential=_e(w,we,this.authState.pipe(Pe(d=>!d))).pipe(V(d=>d?.user?d:null),_(s.outsideAngular),b(s.insideAngular))}return Je(this,N,i,{spy:{apply:(w,be,J)=>{(w.startsWith("signIn")||w.startsWith("createUser"))&&J.then(d=>we.next(d))}}})}static \u0275fac=function(r){return new(r||e)(f(Qe),f(et,8),f($),f(R),f(Z),f(Xt,8),f(Yt,8),f(Jt,8),f(Qt,8),f(en,8),f(tn,8),f(U,8))};static \u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"any"})}return e})();var it=(()=>{var t;let n=class n{constructor(){F(this,t,j(rt))}fbLogin(o,i){return l(this,null,function*(){try{return yield p(this,t).signInWithEmailAndPassword(o,i)}catch(s){return console.log(s),!1}})}fbRegistro(o,i){return l(this,null,function*(){try{let s=yield p(this,t).createUserWithEmailAndPassword(o,i);return this.fbSendVerificationEmail(),s}catch(s){return console.log(s),!1}})}fbLogout(){return l(this,null,function*(){try{return yield p(this,t).signOut()}catch(o){console.log(o)}})}fbSendVerificationEmail(){return l(this,null,function*(){return(yield p(this,t).currentUser)?.sendEmailVerification()})}fbUserCredentials(){return l(this,null,function*(){return p(this,t).authState.pipe(B()).toPromise()})}fbIsUserVerified(){return l(this,null,function*(){return new Promise((o,i)=>{p(this,t).authState.subscribe(s=>{o(s?s.emailVerified:!1)},s=>i(s))})})}fbUserEmail(){return l(this,null,function*(){return new Promise((o,i)=>{p(this,t).authState.subscribe(s=>{o(s?s.email:null)},s=>i(s))})})}fbChangePassword(o,i){return l(this,null,function*(){p(this,t).currentUser.then(s=>{if(s){let a=E.auth.EmailAuthProvider.credential(s.email,o);s.reauthenticateWithCredential(a).then(()=>{s.updatePassword(i).then(()=>{console.log("Contrase\xF1a cambiada exitosamente")})})}})})}fbCurrentUser(){return l(this,null,function*(){yield p(this,t).currentUser})}fbDeleteUser(o){return l(this,null,function*(){p(this,t).currentUser.then(i=>{if(i){let s=E.auth.EmailAuthProvider.credential(i.email,o);i.reauthenticateWithCredential(s).then(()=>{i.delete().then(()=>{console.log("Usuario eliminado correctamente")})})}else console.log("No hay ning\xFAn usuario iniciado sesi\xF3n")})})}};t=new WeakMap,n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=v({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var Mr=(()=>{var t,n;let r=class r{constructor(){F(this,t,void 0);F(this,n,void 0);Q(this,t,j(Me)),Q(this,n,j(it)),this.url="http://localhost:8000"}getUser(i){return p(this,t).post(O.urlObtenerUsuario,{email:i})}getRolUsuario(i){return p(this,t).post(O.urlObtenerRolUsuario,{idUsuario:i})}postRegistro(i){return p(this,t).post(O.urlCrearUsuario,i)}putEditarUsuario(i,s,a,c,u,h){return p(this,t).put(`${O.urlEditarUsuario}/${i}`,{nombre:s,apellidos:a,altura:c,objetivo_opt:u,objetivo_num:h})}getIDUsuario(){p(this,n).fbUserEmail().then(i=>{this.getUser(i).subscribe(s=>s?s.respuesta.id.toISOString():null)})}getUsuarioAdmin(i){return p(this,t).post(O.urlUsuarioAdmin,{idUsuario:i})}};t=new WeakMap,n=new WeakMap,r.\u0275fac=function(s){return new(s||r)},r.\u0275prov=v({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();export{G as a,pn as b,at as c,U as d,Z as e,Ue as f,L as g,pe as h,bn as i,vn as j,Qe as k,it as l,Mr as m};
